
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#2196f3">
  <script src="../_static/javascripts/modernizr.js"></script>
  
    <script async src="../_static/cookieconsent.min.js"></script>
    <script>
        window.addEventListener("load", function(){
        window.cookieconsent.initialise({
            "palette": {
            "popup": {
                "background": "#f0f0f0",
                "text": "#999"
            },
            "button": {
                "text": "#fff",
                "background": "#009688"
            }
            },
            "theme": "classic"
        })});
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6ZE82CNZB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-Q6ZE82CNZB');
    </script>
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
  
    <title>T006 Â· Maximum common substructure &#8212; TeachOpenCADD 0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="T007 Â· Ligand-based screening: machine learning" href="T007_compound_activity_machine_learning.html" />
    <link rel="prev" title="T005 Â· Compound clustering" href="T005_compound_clustering.html" />
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#talktorials/T006_compound_maximum_common_substructures" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="TeachOpenCADD 0 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">TeachOpenCADD (WIP ðŸš§)</span>
          <span class="md-header-nav__topic"> T006 Â· Maximum common substructure </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Our talktorials</a></li>
            
            <li class="md-tabs__item"><a href="../installing.html" class="md-tabs__link">Run locally</a></li>
            
            <li class="md-tabs__item"><a href="../contribute.html" class="md-tabs__link">Contribute</a></li>
          <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Talktorials by collection</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="TeachOpenCADD 0 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    <a href="../index.html"
       title="TeachOpenCADD 0 documentation">TeachOpenCADD (WIP ðŸš§)</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Our talktorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html" class="md-nav__link">Talktorials by collection</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../all_talktorials.html" class="md-nav__link">Complete list of talktorials</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="T001_query_chembl.html" class="md-nav__link">T001 Â· Compound data acquisition (ChEMBL)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T002_compound_adme.html" class="md-nav__link">T002 Â· Molecular filtering: ADME and lead-likeness criteria</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T003_compound_unwanted_substructures.html" class="md-nav__link">T003 Â· Molecular filtering: unwanted substructures</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T004_compound_similarity.html" class="md-nav__link">T004 Â· Ligand-based screening: compound similarity</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T005_compound_clustering.html" class="md-nav__link">T005 Â· Compound clustering</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> T006 Â· Maximum common substructure </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">T006 Â· Maximum common substructure</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t006-compound-maximum-common-substructures--page-root" class="md-nav__link">T006 Â· Maximum common substructure</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Introduction-to-identification-of-maximum-common-substructure-in-a-set-of-molecules" class="md-nav__link">Introduction to identification of maximum common substructure in a set of molecules</a>
        </li>
        <li class="md-nav__item"><a href="#Detailed-explanation-of-FMCS-algorithm" class="md-nav__link">Detailed explanation of FMCS algorithm</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#The-simplified-algorithm-description" class="md-nav__link">The simplified algorithm description</a>
        </li>
        <li class="md-nav__item"><a href="#Tricks-to-speed-up-the-run-time" class="md-nav__link">Tricks to speed up the run time</a>
        </li>
        <li class="md-nav__item"><a href="#A)-Bond-elimination" class="md-nav__link">A) Bond elimination</a>
        </li>
        <li class="md-nav__item"><a href="#B)-Use-the-structure-with-the-smallest-largest-fragment-as-the-query" class="md-nav__link">B) Use the structure with the smallest largest fragment as the query</a>
        </li>
        <li class="md-nav__item"><a href="#C)-Use-a-breadth-first-search-(BFS)-and-a-priority-queue-to-enumerate-the-fragment-subgraphs" class="md-nav__link">C) Use a breadth-first search (BFS) and a priority queue to enumerate the fragment subgraphs</a>
        </li>
        <li class="md-nav__item"><a href="#D)-Prune-seeds-not-present-in-all-of-the-other-structures" class="md-nav__link">D) Prune seeds not present in all of the other structures</a>
        </li>
        <li class="md-nav__item"><a href="#E)-Prune-seeds-without-sufficient-growing-potential" class="md-nav__link">E) Prune seeds without sufficient growing potential</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Load-and-draw-molecules" class="md-nav__link">Load and draw molecules</a>
        </li>
        <li class="md-nav__item"><a href="#Run-the-FMCS-algorithm-with-different-input-parameters" class="md-nav__link">Run the FMCS algorithm with different input parameters</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Default-values" class="md-nav__link">Default values</a>
        </li>
        <li class="md-nav__item"><a href="#Set-a-threshold" class="md-nav__link">Set a threshold</a>
        </li>
        <li class="md-nav__item"><a href="#Match-ring-bonds" class="md-nav__link">Match ring bonds</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#A-more-diverse-set:-the-adenosine-A2A-compounds-downloaded-from-ChEMBL" class="md-nav__link">A more diverse set: the adenosine A2A compounds downloaded from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Identification-of-MCS-using-interactive-cut-off-adaption" class="md-nav__link">Identification of MCS using interactive cut-off adaption</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T006_compound_maximum_common_substructures.nblink.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T007_compound_activity_machine_learning.html" class="md-nav__link">T007 Â· Ligand-based screening: machine learning</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T008_query_pdb.html" class="md-nav__link">T008 Â· Protein data acquisition: Protein Data Bank (PDB)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T009_compound_ensemble_pharmacophores.html" class="md-nav__link">T009 Â· Ligand-based pharmacophores</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T010_binding_site_comparison.html" class="md-nav__link">T010 Â· Binding site similarity and off-target prediction</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T011_query_online_api_webservices.html" class="md-nav__link">T011 Â· Querying online API webservices</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T012_query_klifs.html" class="md-nav__link">T012 Â· Data acquisition from KLIFS</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T013_query_pubchem.html" class="md-nav__link">T013 Â· Data acquisition from PubChem</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T014_binding_site_detection.html" class="md-nav__link">T014 Â· Binding site detection</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T015_protein_ligand_docking.html" class="md-nav__link">T015 Â· Protein ligand docking</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T016_protein_ligand_interactions.html" class="md-nav__link">T016 Â· Protein-ligand interactions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T017_advanced_nglview_usage.html" class="md-nav__link">T017 Â· Advanced NGLview usage</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T019_md_simulation.html" class="md-nav__link">T019 Â· Molecular dynamics simulation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T020_md_analysis.html" class="md-nav__link">T020 Â· Analyzing molecular dynamics simulations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T021_one_hot_encoding.html" class="md-nav__link">T021 Â· One-Hot Encoding</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T022_ligand_based_screening_neural_network.html" class="md-nav__link">T022 Â· Ligand-based screening: neural networks</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Run locally</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installing.html" class="md-nav__link">Installing</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Contributors</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contribute.html" class="md-nav__link">For contributors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../api.html" class="md-nav__link">API Documentation</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">External resources</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_resources.html" class="md-nav__link">Python programming introduction</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_resources.html#cheminformatics-resources-collections" class="md-nav__link">Cheminformatics resources collections</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_resources.html#packages-and-webservers-used-in-teachopencadd" class="md-nav__link">Packages and webservers used in TeachOpenCADD</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t006-compound-maximum-common-substructures--page-root" class="md-nav__link">T006 Â· Maximum common substructure</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Introduction-to-identification-of-maximum-common-substructure-in-a-set-of-molecules" class="md-nav__link">Introduction to identification of maximum common substructure in a set of molecules</a>
        </li>
        <li class="md-nav__item"><a href="#Detailed-explanation-of-FMCS-algorithm" class="md-nav__link">Detailed explanation of FMCS algorithm</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#The-simplified-algorithm-description" class="md-nav__link">The simplified algorithm description</a>
        </li>
        <li class="md-nav__item"><a href="#Tricks-to-speed-up-the-run-time" class="md-nav__link">Tricks to speed up the run time</a>
        </li>
        <li class="md-nav__item"><a href="#A)-Bond-elimination" class="md-nav__link">A) Bond elimination</a>
        </li>
        <li class="md-nav__item"><a href="#B)-Use-the-structure-with-the-smallest-largest-fragment-as-the-query" class="md-nav__link">B) Use the structure with the smallest largest fragment as the query</a>
        </li>
        <li class="md-nav__item"><a href="#C)-Use-a-breadth-first-search-(BFS)-and-a-priority-queue-to-enumerate-the-fragment-subgraphs" class="md-nav__link">C) Use a breadth-first search (BFS) and a priority queue to enumerate the fragment subgraphs</a>
        </li>
        <li class="md-nav__item"><a href="#D)-Prune-seeds-not-present-in-all-of-the-other-structures" class="md-nav__link">D) Prune seeds not present in all of the other structures</a>
        </li>
        <li class="md-nav__item"><a href="#E)-Prune-seeds-without-sufficient-growing-potential" class="md-nav__link">E) Prune seeds without sufficient growing potential</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Load-and-draw-molecules" class="md-nav__link">Load and draw molecules</a>
        </li>
        <li class="md-nav__item"><a href="#Run-the-FMCS-algorithm-with-different-input-parameters" class="md-nav__link">Run the FMCS algorithm with different input parameters</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Default-values" class="md-nav__link">Default values</a>
        </li>
        <li class="md-nav__item"><a href="#Set-a-threshold" class="md-nav__link">Set a threshold</a>
        </li>
        <li class="md-nav__item"><a href="#Match-ring-bonds" class="md-nav__link">Match ring bonds</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#A-more-diverse-set:-the-adenosine-A2A-compounds-downloaded-from-ChEMBL" class="md-nav__link">A more diverse set: the adenosine A2A compounds downloaded from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Identification-of-MCS-using-interactive-cut-off-adaption" class="md-nav__link">Identification of MCS using interactive cut-off adaption</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T006_compound_maximum_common_substructures.nblink.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="T006-Â·-Maximum-common-substructure">
<h1 id="talktorials-t006-compound-maximum-common-substructures--page-root">T006 Â· Maximum common substructure<a class="headerlink" href="#talktorials-t006-compound-maximum-common-substructures--page-root" title="Permalink to this headline">Â¶</a></h1>
<p>Authors:</p>
<ul class="simple">
<li><p>Oliver Nagel, CADD Seminars, 2017, CharitÃ©/FU Berlin</p></li>
<li><p>Jaime RodrÃ­guez-Guerra, 2019-2020, <a class="reference external" href="https://volkamerlab.org">Volkamer lab</a>, CharitÃ©</p></li>
<li><p>Andrea Volkamer, 2019-2020, <a class="reference external" href="https://volkamerlab.org">Volkamer lab</a>, CharitÃ©</p></li>
</ul>
<p><strong>Talktorial T006</strong>: This talktorial is part of the TeachOpenCADD pipeline described in the <a class="reference external" href="https://jcheminf.biomedcentral.com/articles/10.1186/s13321-019-0351-x">first TeachOpenCADD paper</a>, comprising talktorials T001-T010.</p>
<section id="Aim-of-this-talktorial">
<h2 id="Aim-of-this-talktorial">Aim of this talktorial<a class="headerlink" href="#Aim-of-this-talktorial" title="Permalink to this headline">Â¶</a></h2>
<p>Clustering and classification of large scale chemical data is essential for navigation, analysis and knowledge discovery in a wide variety of chemical application domains in drug discovery.</p>
<p>In the last talktorial, we learned how to group molecules (clustering) and found that the molecules in one cluster look similar to each other and share a common scaffold. Besides visual inspection, we will learn here how to calculate the maximum substructure that a set of molecules has in common.</p>
<section id="Contents-in-Theory">
<h3 id="Contents-in-Theory">Contents in <em>Theory</em><a class="headerlink" href="#Contents-in-Theory" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Introduction to identification of maximum common substructure in a set of molecules</p></li>
<li><p>Detailed explanation of the FMCS algorithm</p></li>
</ul>
</section>
<section id="Contents-in-Practical">
<h3 id="Contents-in-Practical">Contents in <em>Practical</em><a class="headerlink" href="#Contents-in-Practical" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Load and draw molecules</p></li>
<li><p>Run the FMCS algorithm with different input parameters</p></li>
<li><p>A more diverse set: the EGFR compounds downloaded from ChEMBL</p></li>
<li><p>Identification of MCS using interactive cut-off adaption</p></li>
</ul>
</section>
<section id="References">
<h3 id="References">References<a class="headerlink" href="#References" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Dalke A, Hastings J., FMCS: a novel algorithm for the multiple MCS problem. <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3606201/">J. Cheminf. 2013; 5 (Suppl 1): O6</a></p></li>
<li><p>Raymond JW., Willet P., Maximum common subgraph isomorphism algorithms for the matching of chemical structures. <a class="reference external" href="https://link.springer.com/article/10.1023/A:1021271615909">J Comput Aided Mol Des. 2002 Jul; 16(7):521-33</a></p></li>
<li><p><a class="reference external" href="http://dalkescientific.com/writings/diary/archive/2012/05/12/mcs_background.html">Dalkeâ€™s website with info on algorithm</a></p></li>
<li><p><a class="reference external" href="http://www.rdkit.org/docs/Cookbook.html#using-custom-mcs-atom-types">RDKit Cookbook documentation on MCS</a></p></li>
</ul>
</section>
</section>
<section id="Theory">
<h2 id="Theory">Theory<a class="headerlink" href="#Theory" title="Permalink to this headline">Â¶</a></h2>
<section id="Introduction-to-identification-of-maximum-common-substructure-in-a-set-of-molecules">
<h3 id="Introduction-to-identification-of-maximum-common-substructure-in-a-set-of-molecules">Introduction to identification of maximum common substructure in a set of molecules<a class="headerlink" href="#Introduction-to-identification-of-maximum-common-substructure-in-a-set-of-molecules" title="Permalink to this headline">Â¶</a></h3>
<img alt="Maximum common substructure, highlighted" src="../_images/mymols.png"/>
<p>The maximum common structure (MCS) is defined as the largest substructure that appears in two or more candidate molecules.</p>
<ul class="simple">
<li><p>Finding the MCS = maximum common subgraph isomorphism problem</p></li>
<li><p>Has many applications in the field of cheminformatics: similarity search, hierarchical clustering, or molecule alignment</p></li>
<li><p>Advantages:</p>
<ul>
<li><p>Intuitive <span class="math notranslate nohighlight">\(\rightarrow\)</span> shared structure among candidates likely to be important</p></li>
<li><p>Provides insight into possible activity patterns</p></li>
<li><p>Easy visualization by simply highlighting the substructure</p></li>
</ul>
</li>
</ul>
<p>Details on MCS algorithms (see review: <a class="reference external" href="https://link.springer.com/article/10.1023/A:1021271615909">J Comput Aided Mol Des. 2002 Jul; 16(7):521-33</a>)</p>
<ul class="simple">
<li><p>Determining an MCS between two or more graphs is an NP-complete problem</p></li>
<li><p>Algorithms for exact determination as well as approximations exist</p>
<ul>
<li><p>Exact: Maximum-clique, backtracking, dynamic programming</p></li>
<li><p>Approximate: Genetic algorithm, combinatorial optimization, fragment storage, â€¦</p></li>
<li><p>Problem reduction: Simplify the molecular graphs</p></li>
</ul>
</li>
</ul>
<p>Example of an implementation: <a class="reference external" href="http://dalkescientific.com/writings/diary/archive/2012/05/12/mcs_background.html">FMCS</a> algorithm</p>
<ul class="simple">
<li><p>Models MCS problem as a graph isomorphism problem</p></li>
<li><p>Based on subgraph enumeration and subgraph isomorphism testing</p></li>
</ul>
</section>
<section id="Detailed-explanation-of-FMCS-algorithm">
<h3 id="Detailed-explanation-of-FMCS-algorithm">Detailed explanation of FMCS algorithm<a class="headerlink" href="#Detailed-explanation-of-FMCS-algorithm" title="Permalink to this headline">Â¶</a></h3>
<p>As explained in <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3606201/">J. Cheminf. 2013; 5(Suppl 1): O6</a> and the respective <a class="reference external" href="https://www.rdkit.org/docs/source/rdkit.Chem.fmcs.fmcs.html">RDKit FMCS documentation</a>.</p>
<section id="The-simplified-algorithm-description">
<h4 id="The-simplified-algorithm-description">The simplified algorithm description<a class="headerlink" href="#The-simplified-algorithm-description" title="Permalink to this headline">Â¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>best_substructure = None
pick one structure in the set as query, all other as targets
for each substructure in the query:
    convert into a SMARTS string based on the desired match properties
    if SMARTS pattern exists in all of the targets:
        then it is a common substructure
        keep track of the maximum of such substructure
</pre></div>
</div>
<p>This simple approach alone will usually take a long time, but there are certain tricks used to speed up the run time.</p>
</section>
<section id="Tricks-to-speed-up-the-run-time">
<h4 id="Tricks-to-speed-up-the-run-time">Tricks to speed up the run time<a class="headerlink" href="#Tricks-to-speed-up-the-run-time" title="Permalink to this headline">Â¶</a></h4>
<p><img alt="c359f7eacf2749f2b44e87f2c8d3d589" class="no-scaled-link" src="../_images/speed_tricks.jpg" style="width: 800px;"/></p>
</section>
<section id="A)-Bond-elimination">
<h4 id="A)-Bond-elimination">A) Bond elimination<a class="headerlink" href="#A)-Bond-elimination" title="Permalink to this headline">Â¶</a></h4>
<ul class="simple">
<li><p>Remove bonds that cannot be part of the MCS</p></li>
<li><p>Atom and bond type information has to be present in every input structure</p></li>
<li><p>Bond type: string consisting of SMARTS of the first atom, the bond and the second atom</p></li>
<li><p>Exclude all bond types not present in all input structures, delete respective edges</p></li>
<li><p>Result: fragmented structures with all atom information, but fewer edges (bonds)</p></li>
</ul>
</section>
<section id="B)-Use-the-structure-with-the-smallest-largest-fragment-as-the-query">
<h4 id="B)-Use-the-structure-with-the-smallest-largest-fragment-as-the-query">B) Use the structure with the smallest largest fragment as the query<a class="headerlink" href="#B)-Use-the-structure-with-the-smallest-largest-fragment-as-the-query" title="Permalink to this headline">Â¶</a></h4>
<ul class="simple">
<li><p>Heuristic approach:</p>
<ul>
<li><p>Find largest fragment of each input structure</p></li>
<li><p>Sort input structures ascending by number of bonds in largest fragment</p></li>
<li><p>Solve ties with number of atoms or input order as alternative</p></li>
</ul>
</li>
<li><p>The structure with the smallest largest fragment becomes the query structure</p></li>
<li><p>The ones from the other input structures are the targets</p></li>
</ul>
</section>
<section id="C)-Use-a-breadth-first-search-(BFS)-and-a-priority-queue-to-enumerate-the-fragment-subgraphs">
<h4 id="C)-Use-a-breadth-first-search-(BFS)-and-a-priority-queue-to-enumerate-the-fragment-subgraphs">C) Use a breadth-first search (BFS) and a priority queue to enumerate the fragment subgraphs<a class="headerlink" href="#C)-Use-a-breadth-first-search-(BFS)-and-a-priority-queue-to-enumerate-the-fragment-subgraphs" title="Permalink to this headline">Â¶</a></h4>
<p><strong>C1</strong> * Enumeration based on growing a so called seed * Seed: atoms/bonds in current subgraph, exclusion set (bonds not applicable for growth) * To prevent redundancy: * Initial seed is first bond in the fragment, can potentially grow to size of whole fragment * Second seed is second bond, is excluded from using the first bond * Third seed starts from the third bond, excluded from using the first and second * â€¦</p>
<p><strong>C2</strong> * Seed grows along connected bonds (not in exclusions set or already in seed) * All growing possibilities are considered at every step * E.g. if there are N possible bonds for extension, <span class="math notranslate nohighlight">\(2^{N-1}\)</span> possible new seeds are added to queue * Enumeration ends when there are no new bonds to add to subgraph (exclude seed from queue) * Largest seed will be processed first</p>
</section>
<section id="D)-Prune-seeds-not-present-in-all-of-the-other-structures">
<h4 id="D)-Prune-seeds-not-present-in-all-of-the-other-structures">D) Prune seeds not present in all of the other structures<a class="headerlink" href="#D)-Prune-seeds-not-present-in-all-of-the-other-structures" title="Permalink to this headline">Â¶</a></h4>
<ul class="simple">
<li><p>At each growth state <span class="math notranslate nohighlight">\(\rightarrow\)</span> check if new seed exists in all other structures</p></li>
<li><p>Else: Exclude seed from queue</p></li>
</ul>
</section>
<section id="E)-Prune-seeds-without-sufficient-growing-potential">
<h4 id="E)-Prune-seeds-without-sufficient-growing-potential">E) Prune seeds without sufficient growing potential<a class="headerlink" href="#E)-Prune-seeds-without-sufficient-growing-potential" title="Permalink to this headline">Â¶</a></h4>
<ul class="simple">
<li><p>Evaluation of growth potential from exclusion list and possible edges for extension</p></li>
<li><p>If potential smaller than current best subgraph <span class="math notranslate nohighlight">\(\rightarrow\)</span> exclude seed from queue</p></li>
</ul>
<p>Utilizing these approaches it is then trivial to keep track of the largest subgraph which corresponds to the maximum common substructure.</p>
</section>
</section>
</section>
<section id="Practical">
<h2 id="Practical">Practical<a class="headerlink" href="#Practical" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">widgets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span><span class="p">,</span> <span class="n">Geometry</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">AllChem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Draw</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">rdFMCS</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">PandasTools</span>

<span class="kn">from</span> <span class="nn">teachopencadd.utils</span> <span class="kn">import</span> <span class="n">seed_everything</span>

<span class="n">seed_everything</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">HERE</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">_dh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="n">HERE</span> <span class="o">/</span> <span class="s2">"data"</span>
</pre></div>
</div>
</div>
<section id="Load-and-draw-molecules">
<h3 id="Load-and-draw-molecules">Load and draw molecules<a class="headerlink" href="#Load-and-draw-molecules" title="Permalink to this headline">Â¶</a></h3>
<p>Cluster data taken from <strong>Talktorial T005</strong> or later EGFR molecules from <strong>Talktorial T001</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sdf</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">HERE</span> <span class="o">/</span> <span class="s2">"../T005_compound_clustering/data/molecule_set_largest_cluster.sdf"</span><span class="p">)</span>
<span class="n">supplier</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ForwardSDMolSupplier</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">supplier</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Set with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="si">}</span><span class="s2"> molecules loaded."</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set with 118 molecules loaded.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show only first 10 molecules -- use slicing</span>
<span class="n">num_mols</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">GetProp</span><span class="p">(</span><span class="s2">"_Name"</span><span class="p">)</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">mols</span><span class="p">[:</span><span class="n">num_mols</span><span class="p">],</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">[:</span><span class="n">num_mols</span><span class="p">],</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_16_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_16_0.png"/>
</div>
</div>
</section>
<section id="Run-the-FMCS-algorithm-with-different-input-parameters">
<h3 id="Run-the-FMCS-algorithm-with-different-input-parameters">Run the FMCS algorithm with different input parameters<a class="headerlink" href="#Run-the-FMCS-algorithm-with-different-input-parameters" title="Permalink to this headline">Â¶</a></h3>
<p>The FMCS algorithm is implemented in RDKit: <a class="reference external" href="https://rdkit.org/docs/source/rdkit.Chem.rdFMCS.html">rdFMCS</a></p>
<section id="Default-values">
<h4 id="Default-values">Default values<a class="headerlink" href="#Default-values" title="Permalink to this headline">Â¶</a></h4>
<p>In the simplest case only a list of molecules is given as a parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mcs1</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"MCS1 contains </span><span class="si">{</span><span class="n">mcs1</span><span class="o">.</span><span class="n">numAtoms</span><span class="si">}</span><span class="s2"> atoms and </span><span class="si">{</span><span class="n">mcs1</span><span class="o">.</span><span class="n">numBonds</span><span class="si">}</span><span class="s2"> bonds."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"MCS SMARTS string:"</span><span class="p">,</span> <span class="n">mcs1</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MCS1 contains 19 atoms and 22 bonds.
MCS SMARTS string: [#6]-[#7]1:[#6]:[#6]2:[#6](:[#7]:1):[#7]:[#6](:[#7]1:[#6]:2:[#7]:[#6](:[#7]:1)-[#6]1:[#6]:[#6]:[#6]:[#8]:1)-[#7]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Draw substructure from Smarts</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">mcs1</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">"MCS1"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_20_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_20_0.png"/>
</div>
</div>
<p>Define a helper function to draw the molecules with the highlighted MCS.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">highlight_molecules</span><span class="p">(</span><span class="n">molecules</span><span class="p">,</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">same_orientation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">"""Highlight the MCS in our query molecules"""</span>
    <span class="n">molecules</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">molecules</span><span class="p">)</span>
    <span class="c1"># convert MCS to molecule</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">mcs</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
    <span class="c1"># find the matching atoms in each molecule</span>
    <span class="n">matching</span> <span class="o">=</span> <span class="p">[</span><span class="n">molecule</span><span class="o">.</span><span class="n">GetSubstructMatch</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">[:</span><span class="n">number</span><span class="p">]]</span>

    <span class="n">legends</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">GetProp</span><span class="p">(</span><span class="s2">"_Name"</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">]</span>

    <span class="c1"># Align by matched substructure so they are depicted in the same orientation</span>
    <span class="c1"># Adapted from: https://gist.github.com/greglandrum/82d9a86acb3b00d3bb1df502779a5810</span>
    <span class="k">if</span> <span class="n">same_orientation</span><span class="p">:</span>
        <span class="n">mol</span><span class="p">,</span> <span class="n">match</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">matching</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">GetConformer</span><span class="p">()</span><span class="o">.</span><span class="n">GetAtomPosition</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">match</span><span class="p">]</span>
        <span class="n">coords2D</span> <span class="o">=</span> <span class="p">[</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point2D</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">mol</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">molecules</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">number</span><span class="p">],</span> <span class="n">matching</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">number</span><span class="p">]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">coord_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">match</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">coord</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coords2D</span><span class="p">)}</span>
            <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coordMap</span><span class="o">=</span><span class="n">coord_dict</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span>
        <span class="n">molecules</span><span class="p">[:</span><span class="n">number</span><span class="p">],</span>
        <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">,</span>
        <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">highlightAtomLists</span><span class="o">=</span><span class="n">matching</span><span class="p">[:</span><span class="n">number</span><span class="p">],</span>
        <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">highlight_molecules</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">mcs1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_23_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_23_0.png"/>
</div>
</div>
<p>Save image to disk</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img</span> <span class="o">=</span> <span class="n">highlight_molecules</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">mcs1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">useSVG</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Get SVG data</span>
<span class="n">molsvg</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Set background to transparent &amp; Enlarge size of label</span>
<span class="n">molsvg</span> <span class="o">=</span> <span class="n">molsvg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"opacity:1.0"</span><span class="p">,</span> <span class="s2">"opacity:0.0"</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"12px"</span><span class="p">,</span> <span class="s2">"20px"</span><span class="p">)</span>

<span class="c1"># Save altered SVG data to file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"mcs_largest_cluster.svg"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">molsvg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Set-a-threshold">
<h4 id="Set-a-threshold">Set a threshold<a class="headerlink" href="#Set-a-threshold" title="Permalink to this headline">Â¶</a></h4>
<p>It is possible to lower the threshold for the substructure, for example so that the MCS only has to occur in e.g.Â 80% of the input structures.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mcs2</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"MCS2 contains </span><span class="si">{</span><span class="n">mcs2</span><span class="o">.</span><span class="n">numAtoms</span><span class="si">}</span><span class="s2"> atoms and </span><span class="si">{</span><span class="n">mcs2</span><span class="o">.</span><span class="n">numBonds</span><span class="si">}</span><span class="s2"> bonds."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"SMARTS string:"</span><span class="p">,</span> <span class="n">mcs2</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MCS2 contains 22 atoms and 25 bonds.
SMARTS string: [#6]-[#7]1:[#6]:[#6]2:[#6](:[#7]:1):[#7]:[#6](:[#7]1:[#6]:2:[#7]:[#6](:[#7]:1)-[#6]1:[#6]:[#6]:[#6]:[#8]:1)-[#7]-[#6]-[#6]-,:[#6]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Draw substructure</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">mcs2</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">([</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">],</span> <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s2">"MCS1"</span><span class="p">,</span> <span class="s2">"MCS2: +threshold=0.8"</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_28_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_28_0.png"/>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">highlight_molecules</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">mcs2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_29_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_29_0.png"/>
</div>
</div>
<!-- FIXME: CI - CHEMBL27685 id is not in this subset, check that T005 produces deterministic outputs --><p>As we can see in this example, some molecules were now left out due to the set threshold (<code class="docutils literal notranslate"><span class="pre">0.8</span></code>). This threshold allows to find a larger common substructure that contains, e.g., a benzene with a meta-substitution fluor pattern and a longer alkane chain.</p>
</section>
<section id="Match-ring-bonds">
<h4 id="Match-ring-bonds">Match ring bonds<a class="headerlink" href="#Match-ring-bonds" title="Permalink to this headline">Â¶</a></h4>
<p>In the above example it may not be obvious, but by default ring bonds can match non-ring bonds. Often from an application point of view, we want to retain rings. Thus, one can set the <code class="docutils literal notranslate"><span class="pre">ringMatchesRingOnly</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then only ring bonds match with other ring bonds.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mcs3</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ringMatchesRingOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"MCS3 contains </span><span class="si">{</span><span class="n">mcs3</span><span class="o">.</span><span class="n">numAtoms</span><span class="si">}</span><span class="s2"> atoms and </span><span class="si">{</span><span class="n">mcs3</span><span class="o">.</span><span class="n">numBonds</span><span class="si">}</span><span class="s2"> bonds."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"SMARTS string:"</span><span class="p">,</span> <span class="n">mcs3</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MCS3 contains 20 atoms and 23 bonds.
SMARTS string: [#6&amp;!R]-&amp;!@[#7&amp;!R]-&amp;!@[#6&amp;R]1:&amp;@[#7&amp;R]:&amp;@[#6&amp;R]2:&amp;@[#7&amp;R]:&amp;@[#7&amp;R](:&amp;@[#6&amp;R]:&amp;@[#6&amp;R]:&amp;@2:&amp;@[#6&amp;R]2:&amp;@[#7&amp;R]:&amp;@1:&amp;@[#7&amp;R]:&amp;@[#6&amp;R](:&amp;@[#7&amp;R]:&amp;@2)-&amp;!@[#6&amp;R]1:&amp;@[#6&amp;R]:&amp;@[#6&amp;R]:&amp;@[#6&amp;R]:&amp;@[#8&amp;R]:&amp;@1)-&amp;!@[#6&amp;!R]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Draw substructure</span>
<span class="n">m3</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">mcs3</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">([</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">],</span> <span class="n">legends</span><span class="o">=</span><span class="p">[</span><span class="s2">"MCS1"</span><span class="p">,</span> <span class="s2">"MCS2: +treshold=0.8"</span><span class="p">,</span> <span class="s2">"mcs3: +ringmatch"</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_33_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_33_0.png"/>
</div>
</div>
<p>We can see here that depending on the chosen thresholds and parameters, we get slightly different MCS. Note that there are more parameter options available in the <a class="reference external" href="https://www.rdkit.org/docs/GettingStartedInPython.html#maximum-common-substructure">RDKit FMCS module</a>, e.g.Â considering atom, bond or valence matching.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">highlight_molecules</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">mcs3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_35_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_35_0.png"/>
</div>
</div>
</section>
</section>
<section id="A-more-diverse-set:-the-adenosine-A2A-compounds-downloaded-from-ChEMBL">
<h3 id="A-more-diverse-set:-the-adenosine-A2A-compounds-downloaded-from-ChEMBL">A more diverse set: the adenosine A2A compounds downloaded from ChEMBL<a class="headerlink" href="#A-more-diverse-set:-the-adenosine-A2A-compounds-downloaded-from-ChEMBL" title="Permalink to this headline">Â¶</a></h3>
<p>We restrict the data to only highly active molecules (but not the covalent ligands) (pIC50&gt;8 pIC50 &lt; 9.5) and detect the maximum common scaffold in this subset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read full EGFR data</span>
<span class="n">mol_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">HERE</span> <span class="o">/</span> <span class="s2">"../T001_query_chembl/data/A2A_compounds.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Total number of compounds:"</span><span class="p">,</span> <span class="n">mol_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Only keep molecules with pKi &gt; 8 (Ki &lt; 1nM)</span>
<span class="n">mol_df</span> <span class="o">=</span> <span class="n">mol_df</span><span class="p">[</span><span class="n">mol_df</span><span class="o">.</span><span class="n">pKi</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">mol_df</span> <span class="o">=</span> <span class="n">mol_df</span><span class="p">[</span><span class="n">mol_df</span><span class="o">.</span><span class="n">pKi</span> <span class="o">&lt;</span> <span class="mf">9.5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Number of compounds with pKi &gt; 8 and pKi &lt; 9.5:"</span><span class="p">,</span> <span class="n">mol_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total number of compounds: 3838
Number of compounds with pKi &gt; 8 and pKi &lt; 9.5: 72
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add molecule column to data frame</span>
<span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">mol_df</span><span class="p">,</span> <span class="s2">"smiles"</span><span class="p">)</span>
<span class="n">mol_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>Ki</th>
<th>units</th>
<th>smiles</th>
<th>pKi</th>
<th>ROMol</th>
</tr>
</thead>
<tbody>
<tr>
<th>58</th>
<td>CHEMBL184061</td>
<td>0.33</td>
<td>nM</td>
<td>Nc1nc(NCCN2CCN(c3ccc(F)cc3F)CC2)nc2nc(-c3ccco3...</td>
<td>9.481486</td>
<td><img alt="Mol" data-content="rdkit/molecule" src="data:image/png;base64,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"/></td>
</tr>
<tr>
<th>59</th>
<td>CHEMBL1093270</td>
<td>0.38</td>
<td>nM</td>
<td>CCCn1c(=S)sc2c1ncn1nc(-c3ccco3)nc21</td>
<td>9.420216</td>
<td><img alt="Mol" data-content="rdkit/molecule" src="data:image/png;base64,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"/></td>
</tr>
<tr>
<th>60</th>
<td>CHEMBL393410</td>
<td>0.40</td>
<td>nM</td>
<td>COCCOc1ccc(N2CCN(CCn3ncc4c3nc(N)n3nc(-c5ccco5)...</td>
<td>9.397940</td>
<td><img alt="Mol" data-content="rdkit/molecule" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAABmJLR0QA/wD/AP+gvaeTAAAUUElEQVR4nO3cfVzNd//A8fe5qw5O6wYl5Rcucn+Tm0j3+u3RNBt25aIwXVy5FhsKjXkQc9P4XcOGa5FSS7mJrFQMCVsxhbS5ybqR1KMbUnI6O6dz3r8/vq216tQ58ZFj7+djf2yn7/d7Pt/1Ot/z+d7AQ0Qg5GXjd/YAyJuJwiJMUFiECQqLMEFhESYoLMIEhUWYoLAIExQWYYLCIkxQWIQJCoswQWERJigswgSFRZigsAgTFBZhgsIiTFBYhAkKizBBYREmKCzCBIVFmKCwCBMUFmGCwiJMUFiECQqLMEFhESYoLMIEhUWYoLAIExQWYYLCIkxQWIQJCoswQWERJigswgSFRZigsAgTFBZhgsIiTFBYhAkKizBBYREmKCzCBIVFmKCwCBMUFmGCwiJMUFiECQqLMEFhESYoLMIEhUWYoLAIExQWYYLCIkxQWIQJCoswQWERJigswgSFRZigsAgTFBZhgsIiTFBYhAkKizBBYREmKCzCBIVFmKCwCBMUFmGCwiJMUFiECQqLMEFhESZ0I6zZs6G8HO7ehagoiIwEAEhMhNu3O3tYRD3dCKtrV/jiC5BKobISyspAqYTHj0Eq7exhEfWEnT0AjRgZwdChcPEiAEBaGqhUcP06DBvW2cMi6unGEQsA5s+H8+cBAFxd4dNPwdMTpFK4caOzh0XU4CFiZ4+hfT/+CFVVUFAADg6ACLa2cPcuPH0KlZVgYwMDBnT2+EgLuhGWXA76+iASgVz+x4sKBUREwMKFwNeZw+5fiG78TvT0oGtXUCigtvaPFy9ehN694cmTzhsWUU83jlgA0KcPPHwIRUVgZdXZQ3kx+0pKBDyeoVDo1aNHZ4+FId04KwQAB4dzxcUlT586W1n9T2eP5YVUK5XLLS1145viBejMDpaUbLp8+cPHjws6eyAvqk6p/Las7Ieams4eCFs6E5aJiQkAVFVVdfZAXpRYIPA1N3d8661tDx9eeXPz0o2wELGsrAwAjhw5ItXxK+4uRkYAcPbJk6Pl5QF5eZerqzt7REzoQFiFhYXu7u7p6ekmJiZHjhyxtrYODg6u1tnfxziJBAD+18RkVs+ecpVqVV7ehbKyNpavrKw8evRobW2trpxmNcBXztkZnz7FtDS8dKmdJVUqDA+vkkgMAcDc3DwoKGjw4MEAIBKJRozIW78eq6peyYiZ2fvo0bSsLPP+/SMjI5u+rlQqMzMzQ0JC3N3dhUIhANja2i5YsECpVHbWULXVobDOn8eDB7G8vGNv6eODq1djcjIeO4aVlWoXKyxEd3cEQEfHWC8vr4qKij179gDA8OHDPTzWACAAGhtjYCAeOYKIePhwx4bTyTb/5z8AIBAIDh48WF5eHh0d7e3t3b1798ZPvoGBgZ2dnYGBAQDMnTu3vr6+s4esEe3DCgvDmBgsKsI5c1Au78BbBgbizp24aRP6+iIA9uuHfn549ChWVmJODv70EyLinj0okSAA9uiBcXENH9Pdu3cbGxsLBAJr63vDhqGdHQKgjw++/TYWF+PSpR0Yy2th8+bNAMDn8/lN7iH06dPHxcVl/Pjx+vr6mZmZly9fNjQ0BAAvLy95u//bHzzAHTvwxAlUqV7JHrRCm7BUKrx7FxctavjPHTvwzp0OvGVgICoUaG+PM2eiWIzcsQcA+Xz8xz/QwwOlUvzkExwzBt99Fx89+tO61dXVX30V3707AuD06XjpEkZH46lTuGSJDoeFiNOnTzcxMRGJROPGjbOzs7OwsGgsTCAQ7N+/HxGvXbvGnRp7enrW1dWp3ZZMhvPmYU0NJibi3r2vbh/+TLOwqqowNBSHDcOuXXHJEnz6FBExKAgrKrR6s9panDEDo6IQEX/5BR8+RIUCMzMxJATd3VEsxqVLMS4ON27EZcsa3qRVz57h9u144wYi4okTePkyHjqEdnZajeX1MmPGDAD45ptv9u7dy/XUvXt3Ly+v0NDQ0tLSxsWuX7/OfUt6eHhIpdLmW8nJwW3bMDISd+1qeOXf/35Ve9BcW2GpVKq0tDRvb+88J6eGo4qlJSYmYkAABgfj3r1YUoKFhZq/WWAgAqgtoK4Ow8IwOxs3bcJp0zTd5o0beOsW5ubi2rWaD+T1olKpuFzy8/OLioo+//zzzMxMdfP0X375pVevXgDg7Oz87Nmz6urqEydOfLNmDVpZNfyOfHxw1SpExIoKDAp6pXvShNqwHj58OGjQIO7T89HIkejpiQkJ2HTmePs2Wlri8OFYU6PJO2Vno0iEAgE6OGBiYuvLJCZibi5KpfjPf2qxD+vXIwCuX6/FKq+V7OxsALCystJw+ca2zM3NRSIRALxlaKgQCrFXL/T1xaQkjIjADRswKAgLC3HmTMzOZjr+VqkNa926dRKJxMzMLCgoKD8/v5Ulampw+HAEQA8PbO9Upb6+furU2aNHn580CQFwwAD87bfWl1y9GkUi3LlTi33YtQsB8JNPtFiFkdLS0tzcXG1P3Hbt2gUAH374oear5OfnGxkZWVhYCIVCR0fHLVu21GZntzJVDw5GADQ1xczMtjcok8le7vmm2rCGDBkCAHFxcSkpKdXV1a0vlJeH3bvHTZjwWXuH3K+++goALCwsHB19TU0rzp1TuyT3v0Krw09UFALg3LlarPIS1dfXc9ecJk2axOPx3NzcBg8enJubq/kWpk+fDgARERGaLFxaWmpra7ty5UqBQKCnp9d0BtYKmQzffx8B5AMHXs3IaPnz/Pz80NBQLy8vQ0PDNWvW7NixQ/Nht01tWJMmTQIA7oLk1atX1S1WnJ7OXWIJCwtr+npNTc2DBw9u3LiRmpq6f/9+iUQCAKNGjQKAhQvbmlF24PBz5sxjB4d7ixdnabHOCyspKQkPD/fy8jIyMmo8g+vatWvv3r25j9Dt27c12U7jBKugoECT5WNjY7nrpQDg4uLS/gpyeZ2vr0ffvhKJ5NKlS4hYV1d35syZ5cuX29jYNI6cx+NxFzu2bNmiyTDapTasqVOnNu5ASkpKG5sIDw8HAKFQaGtra2Nj07NnT+5icVOWlpZ9+vTx8vIyNTUtb/PK6uHDz4YNq1m2rETzffjxxx8BwN7eXvNVXoRSqbSzs+PxeI17N2jQoOXLl3///fcymay2ttbNzQ0Axo51unWr/a3dvHmTu2ql4bsvWrQIABwcHAAgODhYk1Xq6+vnzJkDAGKx2N7evkuXLo0jNzY2njlzZkRERGlpaXh4uEAgAID0L7/UcDBtUBvWvHnzAGDChAkAEBMT0+oyRUVFI0aMSElJsba2NjMza1qSRCLp06fPyJEjXV1dPTw8uKNaSEhISUk7xZw6dYq7VKP5Pty+fZs7uGq+yotwdXXt1auXWCx2d3cPCQm50+JinlQq9fb2MzcvNjXFrPYOo1u3bgWA+fPnI2JRUVG7784dZgYOHAgAaWlpGo5ZpVL5+/s3no0NGTIkKCjo7Nmzza61Hjp0KMTNDQEazitfgNqwli1b1vjJ2L17d6vLvP/++wAwfvx4rv3k5OQ7d+6UlZW1vDT83XffcVeWk5Nb/4KQy+XHjh1buHBheno6AEycOFHzfSgsLAQAExOTV3ArraioCACMjIxauYzUhEyG772HAGhkhFeuNP+pSoXXr9/avHmzg4MDn883NTX19vY+cOCAgYFBfHx8G5stKSkBgG7duvH5fAMDg7Yuk7agUqmqq6tjYmLamZbFxaGeHgLgihWt/ry8vPzo0aN+fn4zZsxoYzNqw9qwYQMAODo6AsDGjRtbLnD8+HHuyMRNEZrdRm1p27b/c3LK7tYNb9780+t5ebh6Nbq6enEfpn379gGAtbW1hpVcuXLFxsZGT09PT0/P1dW1rKxMk7U67ODBgwAwTYPrbAoFzpmDRkbo64s1NVhUhAkJmJCAfn5oaYmTJjVcCBWJRNy3KjepFYlEcXFx6rYZExPTOD9xdXV9qXvWRFISGhpiQgKmp+PXX+OdO1hfjz/8gJ99hra2E3r35kYuEAiq1D8FoDYs7jyOO2ItX7682U9ramosLS25QwsAODs7qzS4LfWvfyEAWlhgcXHDK+npyOcjAE6YcKxfv37cDKBLly5CoXDo0KGRkZFtnAPX1dUFBQVx04K+ffsaGxtzRWZlaTC16agVK6K6deul4dmTQoH376OPD65bhz//zJ2fNfzj6Vng5+cXHx9fU1MTHR3NzUrt7e3h9xvSrW4wODiYz+dzv5QNGza81D37s8pKvHQJQ0Kwqgr9/XHx4sahH5k82dPTc/fu3b/++msbG1AbVnR0NABMnjzZx8cnirsL08SSJUu4aQ2Px9PX1285z2iVTIYODsjnY3R0wyv19fi3v+GECTh06G89e5pzpyejR4/u/fvHYtCgQVFRUQqFotmmbt68yZ1jCoVCZ2fn+fPnFxcXT5w40di4f//+8v372x9McWPd2rC2RqEQs7O1+A4KDMQvv8RDh3DtWnRzw+3b8eefmy9z+PBhri0nJycA4PP5Bw4caHVrjx8/HjZsGABcvHixA+PXwoYNDXdqz57F9evRxgaXLcMzZ1Cz71+1YSUlJXFnKzExMc1m3Dk5OXw+XyQS9evXT90XpTrl5ZiUhI6OWFCA2dk4b17DUwwAOGXKF4GBgXfv3kVEuVweGRk54Pc/imptbb1z506ZTMb9KCQkhLvibGVlxS3D5/NzcnJkMtmaNY+4rS1ahDJZ83f/7Te8cOGHlStXDh8+HAAWLFjwpTZnQA8eIACamKBWc7nAQJTL8Z13MDS0rcUSEhL09fUbT5iEQmGzQ0JeXl5oaOgHH3wgkUjEYrGs5e69XPv2NUwPw8IwPV3btdWGVVFRsXHjxsazvH79+s2dOzc0NLSoqEilUkVEREyePBkAbGxsOrCH/v7o749ZWejnhwA4ZgyGhmLL2bBCoTh48CB3BsTltXbtWu5AxefzuUdKuO/B1NTUxrUiIlAsRqEQZ83C588xNxfj4zE0FKdNQ4kE7exCuK116dKFm9yEhIRoOOzw8IanKrSyfj2Wl2NGRvsPNiYlJXGnzxMnTuSOWM+fPz916pS/vz/3GeaIxeJ2JuAvhVSKn36Kmzbhpk0dWLutm9AFBQXbtm2bMmUKd3mz0eDBg2fNmqWnp8fj8Zr+RjUXGIgnT+LatRgWhu1eR1QqlQkJCaNHjwaArl27cgcq7qybx+MtWbKEe2y3qevXcf9+nDkTN2zAjAycNu2Pyc3MmXdWrVqVmpoql8sbJzdBGtyszcrCmzdx+XL873+12NO6OjQwQIEA1d28aOb06dNisZiby7/99ttcZ5wePXr4+PgcOnSoQsuHSjqFRo/NcHctdu7c2fRC86BBgxYuXNixdw0MRET8+9+xvVPJPyiVyoiICIFAIBKJcnNzzczMrK2tz58/38YqAQH4xRcYFoYbN+KMGbh/Pz582HyZ2NhYrq1V7V25cXPD48fx3j3cs0fTMSPi+fMIgLa2Wqxy8eJFiUTC3VLj8/ljxozhrjm1nGi+zrR+glShUGRkZGzdurW4uFir6yhNcVccHj3S6qEbRMRx48YBQHJy8rVr12rae6oiIABlMnRxwdjYthY7duwYN2P76KOPWp7bKpV49SrGxmJAAC5ZgpmZ2oW1bh0CNHyQNFdQUJCWlqYrB6dWdcIfpngR69atA4CPP/643SVLSzEoCOvqMCOj+ZWzlk6dOsV96fj5+XHXz8rLy2Nijnt7I/e0qkSCS5diYSF6e2sX1uzZ21xcLiQnq39q8Q2lY2FlZGQAwIABA9pdcvv2hofeNJSSksJNbsaNGzd+/HjujqyVVT4A9u+Pixejvz8i4pYtuHIl2tlhe7emEBGlUqm+vn7bFxLfVDoWVn19vampKQDcv3+/7SVHjEAA/O47LTbOTW6GDh3KnXl5eHiEhd26d6/5Yvb2CICDBzd/Hr+lc+fOAcDYsWO1GMSbQsfCQsRZs2YBwNdff93GMjduNDzfpu5xQnVKS0vT0tKSkpKeP3+ubpmyMhw5EgHQySlP3W3jnJyc7du3Dxw4kMfjBWo7w3oj6MzfNtPonXfeOXz4cEpKypQpU3bt2iUWiy0sHOvqPCUSmDwZuEeMvv0WAMDbG/T0tNu4ubm5ubl528v07AmpqeDj8zAnx83JiZeamtq3b18AkEql6enpiYmJJ0+e5O5VA0BgYOCKFSu03sk3QGeXrbXy8nI+ny8Wi0+fPs3tgrNzAHeNKjoai4sxIwN//RUXLGj4YzyMPH36lLu1Z2ZmFhAQ4Orqyp1acszNzX19fY8cOfLkyROGg3iN6cxfvNbU2LFjs7KyHB0dlUqlQCB4663Zz559JJeDqytYWEB0NCQnw8aNsGMH22E8f/78vffe++mnn2prawFAIBCMGjXq3XffnTp1qq2tbdMnAf+CdDKskydPRkVFxcfHc//p4rIpLe0z7t/nzwcnJ7h7F+Ry5mEBgFQqvX//fkREhIODg7u7e9PHlP/idDIsAMjOzr5+/bpCoaiuru7WzfnBg/H19fDsGVhbw6hRkJ8PcXFw4UJnj/IvTFfDUufqVVAqwc4O5syB2NjOHs1f2JsWFnlN6MBfvEZ0EYVFmKCwCBMUFmGCwiJMUFiECQqLMEFhESYoLMIEhUWYoLAIExQWYYLCIkxQWIQJCoswQWERJigswgSFRZigsAgTFBZhgsIiTFBYhAkKizBBYREmKCzCBIVFmKCwCBMUFmGCwiJMUFiECQqLMEFhESYoLMIEhUWYoLAIExQWYYLCIkxQWIQJCoswQWERJigswgSFRZigsAgTFBZhgsIiTFBYhAkKizBBYREmKCzCBIVFmKCwCBMUFmGCwiJMUFiECQqLMEFhESYoLMIEhUWYoLAIExQWYYLCIkxQWIQJCoswQWERJigswgSFRZigsAgTFBZhgsIiTFBYhAkKizBBYREmKCzCBIVFmKCwCBMUFmGCwiJM/D9UVajG3e5wEgAAArB6VFh0cmRraXRQS0wgcmRraXQgMjAyMS4wOS4yAAB4nHu/b+09BiDgZUAANSDWBuIGRjaGBCDNyMzBoACkmSBcJjjNwaABpJmZ2BzANAubQwaIZmZEYkBk2CEqmdFNYAcbjCkM0cYMozHMg5sLVwCzB6yQEYsJqBqxORXK4IAoYcLQiuZImDgn2A8I/dwMjAyMTAxMzEA5BhZWBVa2DCY29gR2jgwmDk4FTi4GLm4Gbh4GHl4GXj4GPn4GfoEEAcEMJkGhBCHhDCZhkQQR0QwmUTEFUfEEcYkECckMJkkpBSnpDCZpmQQZ2QwmWbkESfkEeYUMJh5FBkUlBg7lBGUVBmXVDCZV1gQlTgZh/gQF8QQFoQQ5qQQRNjZWVWUOdjY2Lm4eRSVOVgF+YSFBNhFRcQUhYVYJcQV5SVZpKTlZGfFLjEA/wFOAMUeRY1PU/r0gTsXnKEdFLcb9IPbxbZ6Orhxc9iA29yIjx4uqzHYgdnSqouPbv1PB4vMDuBy59jqB2VMqWBz1thiC9W44fsuhobIXzPb32+HQzVkDNv+GSpfDlX8f94HY78L8Hf4aCYH1/mN/Zr/+gjLY/CXu2+3b9i0F6z0ro7/nfewtMHuvc/f+8k5NMPvcF8UDKimdYPbR904HPG7JHQDbmz/xwI4IaTC7a/q8A2riNWA1cU25B2qaxMH2PucpOVA2dw3YXmGlpQf+tDM4gNjh6SsO3PNLALPzfpw5sOULxI9T234f4Nt6BMye2Mx1sN2gA+xOr1Klg8071MHsiab6B+9shPh3aY3bQZbHtmC2u7zHwTYLR7Ded7cMD76xWwFm37b+dqC4PAmsRnPzyQMuKcvAbpsyTcHh7mpRsPubX9Y4BO74BlaT9u+wQ0DEJrBe1taFDod+SIPdeVf9k8OO78/A4mIAiETBY2rMy5kAAAN1elRYdE1PTCByZGtpdCAyMDIxLjA5LjIAAHicfVZbbiM3EPzXKXgBEewXm/xc27uLIFgJSJzcYf9zf6RqZHO0CBHJbMzQNWSxuqtHl8LPH2+///ynrI++XS6ltP/5m3OWv621dvlReFFevn7/7VZe37+8fM683v+6vf9ZbBQ3PIPvr9gv7/cfnzNSXotEFc3WtFxbbdPcvODi+JzParkXsdqHuzcio3n43CCNa2rtLUVBoIZNGTugEyhVukdX/F90tNztHdwb0yPVo+CJlCG6AXasOGp374M7Z2995gaXB05zOlTCWfp0ib4BDgB7HdZH9nLFzi0g1QY4AYyaMSPmoWOXMNsApZVb8WrSJ6gB6anddySFybGqNvsQ6pjSpuyASiFrzhShzhJYencaMewt1U0GdMZxdPrI7d7MDY8hrY9BaDasutNcglBBdkZrcajZVWOXR+nY/6qoiBY9j4fSrO9qQ5JQqyiyMZwP+VCgd1Am6eo13D+hmjp3WZL5gDJL88j8HNB/7Oq9EWoVmrZxWEM8Z+y4qjy4DjEdCYHNR0TskMzUFX7rzdssCsCwtmOqTBWQ2hWVhDKA3YZsjelE9uotTPvDHRB4hwwis47eJAeQYT1zy5NGusJJqDllyWmHYFtkHtln0Vk3IqRbbsXX8QGd0SLHw05wwRZ7JApdBKdCuVL+dEnfUbD2gY2W3Vj3GZ7bqsJKd0CxMTwSjakSd90xMH2IhdYwWicBFNfjhP+BsuMhA9ZM9OiNpo7C2kHpKzKdAiujVM0G87tBxuH+GZKh1GpqxrZUrB9NShREnUeaZvsjZfmGJtU8YRSwcIOpd7VvzFRWeNQ6Kwrr+vbkX29vv7xOHi+Yl/vt7XzB8KvnWwQ3xc5XhWD4+UIQjDjbvmD0s7k7Rp493DHG2akdY579WDie264cQZ7aqxxhkROyY1j8hAQZFkUhR4bFUkiTYREVMkWQxVVIFkEWXSFfBFmM0ZucQZ9bkDPo4qzUB0FPQQ9FFf3iqXP4MbM4o0M4gy7O6AS8hc+fHC8MujgrOSPo4qzkjKCLs5Izgj2b0cvhtCfPOVe2xRnWcgY76+BDZ1ucjToj2OJs5IytFmUjZQRblI2UObMo80cQw/kQCwNLnZXhHyqf+XMyBqVTQdfHzJktp8o42qkXvfBc+bz//FmG68u/xfjV+QoHh1oAAAG2elRYdFNNSUxFUyByZGtpdCAyMDIxLjA5LjIAAHicLZJLquQwDEW30sMUOEb/DxkGelhvEZ5Xb+AtviWnCCTkWJ+rK98/9/2zcK11vOm+38d9f/izlqx6H+9X/xzn0gr4p6/PEn7dN73W8fe18M/vgTqRfJwwIVnqGRfytBBppiAqWYimgeMowonRBCeaWBGkAJciVSKcRh04Bo4rpolYVIgbWHoT8nwqWwqqjctmsEWMs9JAS8ml0zXrqCUZKpOOSybjFilOJhXEkzh3bXWErG44PR2pBWmmWxNhDO/SlFI9ri6J8G3nUHHFsGTHlmREWoOcVFOC7kRw5mp38iwnOoymBEEjmSryReSUG32FZ5TQ2HmOCLs8iqfmZoFc8ThZoj04awcGgoMmQPAGZGQ4uDfQXp42BZT5cVc7xmcYYBRRNu9mZbg+FpDVbNrDtR2812Ts+ZBUsMdwexygLr7X4oIu+jAF70RXcdthlVHetm4UoS2h1ljyKjFCjHULZeASUYxJyohxdanEbKeYo8aq9aWia4tIqm9dAyTpWTiZqS8BiNfNK2Xspfbyqea1CpwBUrf09fsfg56cV9k5gW4AAAAASUVORK5CYII="/></td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p>We do our calculations on the selected highly active molecules only.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mols_diverse</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Note: discarded variables we do not care about are usually referred to with a single underscore</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">mol_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">smiles</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="s2">"_Name"</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">molecule_chembl_id</span><span class="p">)</span>
    <span class="n">mols_diverse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In the interest of time, we randomly pick 50 molecules from this set.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># We have fixed the random seed above (imports) for deterministic results</span>
<span class="n">mols_diverse_sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">mols_diverse</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We now calculate the same three variants of MCSs as described above and draw the respective substructures. We use a slightly lower threshold to account for the larger diversity in the set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">threshold_diverse</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">mcs1</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">mols_diverse_sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"SMARTS string1:"</span><span class="p">,</span> <span class="n">mcs1</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="n">mcs2</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">mols_diverse_sample</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold_diverse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"SMARTS string2:"</span><span class="p">,</span> <span class="n">mcs2</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="n">mcs3</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">mols_diverse_sample</span><span class="p">,</span> <span class="n">ringMatchesRingOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold_diverse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"SMARTS string3:"</span><span class="p">,</span> <span class="n">mcs3</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SMARTS string1: [#6]-,:[#6]-,:[#7]:,-[#6]:[#7]:,-[#6]
SMARTS string2: [#6]:,-[#7]:,-[#6]:,-[#7]:,-[#6]-,:[#6]:,-[#6]:,-[#6]:,-[#6]
SMARTS string3: [#6&amp;R]1:&amp;@[#6&amp;R]:&amp;@[#7&amp;R]:&amp;@[#6&amp;R]:&amp;@[#7&amp;R]:&amp;@[#6&amp;R]:&amp;@1
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Draw substructures</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">mcs1</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">mcs2</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
<span class="n">m3</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">mcs3</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>

<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span>
    <span class="p">[</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">],</span>
    <span class="n">legends</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">"MCS1"</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">"MCS2: +threshold=</span><span class="si">{</span><span class="n">threshold_diverse</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"MCS3: +ringmatch"</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_45_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_45_0.png"/>
</div>
</div>
<p>This time it become more clear that setting <code class="docutils literal notranslate"><span class="pre">ringMatchesRingOnly=True</span></code> provides a more intuitive representation of the scaffold they share.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">highlight_molecules</span><span class="p">(</span><span class="n">mols_diverse_sample</span><span class="p">,</span> <span class="n">mcs3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T006_compound_maximum_common_substructures_47_0.png" src="../_images/talktorials_T006_compound_maximum_common_substructures_47_0.png"/>
</div>
</div>
</section>
<section id="Identification-of-MCS-using-interactive-cut-off-adaption">
<h3 id="Identification-of-MCS-using-interactive-cut-off-adaption">Identification of MCS using interactive cut-off adaption<a class="headerlink" href="#Identification-of-MCS-using-interactive-cut-off-adaption" title="Permalink to this headline">Â¶</a></h3>
<p>We can also change the threshold interactively. For that, we need a helper function, hereby defined. It takes two arguments: <code class="docutils literal notranslate"><span class="pre">molecules</span></code> (fixed, so itâ€™s not configurable with a widget) and <code class="docutils literal notranslate"><span class="pre">percentage</span></code> (the value of which is determined by the interactive widget). Every time you modify the state of the slider, this helper function is called.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">render_mcs</span><span class="p">(</span><span class="n">molecules</span><span class="p">,</span> <span class="n">percentage</span><span class="p">):</span>
    <span class="sd">"""Interactive widget helper. `molecules` must be wrapped in `ipywidgets.fixed()`,</span>
<span class="sd">    while `percentage` will be determined by an IntSlider widget."""</span>
    <span class="n">tmcs</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">molecules</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">percentage</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tmcs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No MCS found"</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">tmcs</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tmcs</span><span class="o">.</span><span class="n">smartsString</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note that the slider may take a few seconds to react</span>
<span class="n">interact</span><span class="p">(</span>
    <span class="n">render_mcs</span><span class="p">,</span>
    <span class="n">molecules</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">mols_diverse_sample</span><span class="p">),</span>
    <span class="n">percentage</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">70</span><span class="p">),</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5edf25686cce46ca8505b3007ccc7da7", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="Discussion">
<h2 id="Discussion">Discussion<a class="headerlink" href="#Discussion" title="Permalink to this headline">Â¶</a></h2>
<p>Maximum substructures that a set of molecules have in common can a useful strategy to visualize common scaffolds. In this talktorial, we have use the FMCS algorithm to find the maximum common substructure within a largest cluster from <strong>Talktorial T005</strong>. An interactive widget allowed us to explore the impact of different thresholds on the maximum common substructure in our dataset.</p>
</section>
<section id="Quiz">
<h2 id="Quiz">Quiz<a class="headerlink" href="#Quiz" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><p>Why is the calculation of the maximum common substructure (MCS) useful?</p></li>
<li><p>Can you briefly describe how an MCS can be calculated?</p></li>
<li><p>How does the typical fragment of an active EGFR compound look like?</p></li>
</ul>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="T005_compound_clustering.html" title="T005 Â· Compound clustering"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> T005 Â· Compound clustering </span>
              </div>
            </a>
          
          
            <a href="T007_compound_activity_machine_learning.html" title="T007 Â· Ligand-based screening: machine learning"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> T007 Â· Ligand-based screening: machine learning </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2018-2021, Volkamer Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>